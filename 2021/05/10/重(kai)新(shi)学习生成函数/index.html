<!DOCTYPE html>
<html>



<head>
  <meta charset="utf-8">
  <%- partial('google-analytics') %>
  <%
  var title = page.title;

  if (is_archive()){
    title = __('archive_a');

    if (is_month()){
      title += ': ' + page.year + '/' + page.month;
    } else if (is_year()){
      title += ': ' + page.year;
    }
  } else if (is_category()){
    title = __('category') + ': ' + page.category;
  } else if (is_tag()){
    title = __('tag') + ': ' + page.tag;
  }
  %>
  <title><% if (title){ %><%= title %> | <% } %><%= config.title %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <%- open_graph({twitter_id: theme.twitter, fb_admins: theme.fb_admins, fb_app_id: theme.fb_app_id}) %>
  <% if (config.feed) { %>
    <%- feed_tag() %>
  <% } else if (theme.rss) { %>
    <%- feed_tag(theme.rss) %>
  <% } %>
  <% if (theme.favicon){ %>
    <%- favicon_tag(theme.favicon) %>
  <% } %>
  <% if (config.highlight.enable){ %>
    <%- css('https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css') %>
  <% } %>
  <%- css('css/style') %>
  <% if (theme.fancybox){ %>
    <%- css('fancybox/jquery.fancybox.min.css') %>
  <% } %>
<meta name="generator" content="Hexo 5.4.0"></head>

<body>



  <div id="container">
    <div id="wrap">

	
		
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ywy_c_asm</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">菜 是 原 罪 | 罪 原 是 菜</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.ywy-c-asm.cn"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer" style="padding:0 0px">
        <section id="main"><article id="post-重(kai)新(shi)学习生成函数" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/%E9%87%8D(kai)%E6%96%B0(shi)%E5%AD%A6%E4%B9%A0%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T11:47:00.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      重(kai)新(shi)学习生成函数
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>说得好听是重新学习，其实OI时期也基本上没怎么敢学习过这种东西……</p>
<span id="more"></span>

<h1 id="多项式exp的组合意义"><a href="#多项式exp的组合意义" class="headerlink" title="多项式exp的组合意义"></a>多项式exp的组合意义</h1><p>多项式exp的组合意义是把若干个有序集合无序地组合起来，典型例子是“无序的若干个连通块”、“无序的若干个子树”，等等。例如，我现在希望求出$n$个点的有编号无根森林的个数，有两种做法：①设$f[i]$为$i$个点有编号无根树的个数（用pruffer序列就是$f[i]=i^{i-2}$），$g[i]$为森林个数，枚举1号点所在连通块大小，$g[n]=\sum_{i=1}^nC_{n-1}^{i-1}f[i]g[n-i]$，②直接用暴力卷积，$n!\sum_{k=1}^n\sum_{a_1+a_2+…+a_k=n}\frac {f[a_1]}{a_1!}\frac{f[a_2]}{a_2!}…\frac{f[a_k]}{a_k!}$，里面嵌入的阶乘们相当于枚举了把$1…n$划分为$k$个集合的方案数，但由于里面是直接<strong>乘</strong>起来，就带有了顺序，而连通块其实是无序的，因此一种方案会被算$k!$次，除了就行。这两种方法看上去不同，实际上可以用数学归纳法证明它们总是相等的<del>（在真的把它证出来之前我一直有点疑虑……）</del></p>
<p>方法②本质上就是多项式exp，我们令$F(x)$为$f$的$EGF$，意义就是把系数直接除个阶乘，它本身没啥意义，但常常因为这样的集合划分正好需要除阶乘，可以直接用EGF的乘积，显然在这种场合下EGF的乘积还是EGF（因为我们还没乘$n!$）。于是：</p>
<p>$G(x)=\sum_{k=1}^{∞}\frac{F(x)^k}{k!}=\exp(F(x))$</p>
<p>而$\ln$的意义仅仅是$\exp$的逆运算而已，例如，我可以很容易算出$n$个点无向图的个数，而它可以看做是一堆连通块组合在一块的，取个$\ln$就是连通图个数。注意这里的所有运算都是针对$EGF$的，需要最后乘个阶乘之类的。</p>
<p>另一个更简单的例子是求$n$个元素划分为若干个无序集合的方案数（即贝尔数$B(n)$），对于若干确定的元素，把它们放在一个集合里的方案数为$1$，对应的指数生成函数$F(x)=\sum_{i=1}^n\frac 1{i!}$（这里不要让$F[0]=1$，切记，<strong>需要exp的东西都不能有0次项</strong>！这样会破坏exp的精确枚举选多少个的组合意义），显然$e^{F(x)}$就是贝尔数的指数生成函数。</p>
<h1 id="CF438E-小朋友与二叉树"><a href="#CF438E-小朋友与二叉树" class="headerlink" title="CF438E 小朋友与二叉树"></a>CF438E 小朋友与二叉树</h1><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/CF438E">题目链接</a></p>
<p>题意：二叉树的每个点的权值都在某个集合${c_1…c_n}$中，对于每个$i=1…m$求权值和为$i$的二叉树个数 mod 998244353，所有数范围$10^5$。</p>
<p>Solution：</p>
<p>有根树是很容易列出自己卷自己的生成函数的，毕竟子树还是二叉树，那么有递推式$f[n]=\sum_{c_k&lt;=n}\sum_{a+b=n-c_k}f[a]f[b]$，注意边界条件是$f[0]=1$，也就是说$f(x)=1+\sum_{i=1}^nx^{c_i}f(x)^2$，令$P(x)=\sum_{i=1}^nx^{c_i}$，则$P(x)f(x)^2-f(x)+1=0$，我们暴力解方程得$f(x)=\frac{1±\sqrt{1-4P(x)}}{2P(x)}$，这样是不能直接做的，因为$[x^0]P(x)=0$，不可逆，需要用分子有理化变一下形：$f(x)=\frac 2{1±\sqrt{1-4P(x)}}$，实际上那个正负无关紧要，只要解出一个满足方程的$f(x)$就行了，正负仅与可行性有关——如果取负，那么分母仍然没0次项，不可逆，因此取正。于是多项式开根+求逆就做完了。</p>
<h1 id="Luogu-P5434-有标号荒漠计数"><a href="#Luogu-P5434-有标号荒漠计数" class="headerlink" title="Luogu P5434 有标号荒漠计数"></a>Luogu P5434 有标号荒漠计数</h1><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5434">题目链接</a></p>
<p>题意：求$n$个点的荒漠图（即每个连通块都是仙人掌）的个数 mod 998244353，$n&lt;=10^5$</p>
<p>Solution:</p>
<p>我们先求出仙人掌的EGF，再exp一下就是答案。这个东西看上去就像把一些环像树一样组合起来，但直接组合还是不好做，因为一个点可以连多个环，所以我们考虑求出<strong>有根</strong>仙人掌的个数，最后除个点数就行（因为每个点都当了一遍根），然后就变成了自己卷自己的自我递推关系。令有根仙人掌的EGF为$F(x)$，考虑与根相连的东西，①一个割边，也就是说它连了另一个有根仙人掌，根是它连的那个点，对应的生成函数还是$F(x)$；②一个环，这个的计算方式其实和链是差不多的，假如这个环上有包括它自己的$i+1$个点，那么每个点都可以是一个以它为根的仙人掌，并且这些点的排布是有序的，可以直接乘起来——但由于这是环，正着走和反着走会算两遍，需要除2，对应的生成函数为$\sum_{i=2}^∞\frac{F(x)^i}2$。然后我们需要把根连的这些部分无序组合起来，就是exp了，即$F(x)=xexp(\frac{2F(x)-F(x)^2}{2-2F(x)})$，前面乘个x是因为根已经算了一个点，由于我们所有的组合都是基于有根仙人掌的根进行的，所以需要$[x^0]F(x)=0$。然后牛顿迭代即可。<del>这玩意常数可真tm大</del></p>
<h1 id="边双连通图计数"><a href="#边双连通图计数" class="headerlink" title="边双连通图计数"></a>边双连通图计数</h1><p>我们仍然采用“有根图”的方式，你会发现这具有很强的计数递推性（图的根是根边双连通图的根），解决了很大的问题。令$G(x)$为无向连通有根图的EGF（其实就是额外乘了个点数），$F(x)$为有根边双连通图的EGF。对于任意一个无向连通图，都可以看成边双构成的树（边双连通图那就是一个点），我们假设$f_n$为$n$个点有根边双连通图的个数，枚举整个图的边双树的根有多少点，这个边双的儿子都是普通有根无向图，那么：</p>
<p>$G(x)=\sum_{n=1}^∞\frac {f_n}{n!}x^n\sum_{k=0}^∞n^k\frac{G(x)^k}{k!}=\sum_{n=1}^∞\frac {f_n}{n!}x^n\exp(G(x))^n$</p>
<p>然后我们惊奇的发现后面那个其实就是把$x\exp G(x)$代入了$F$中！于是$G(x)=F(xe^{G(x)})$，扩展拉格朗日反演解出$[x^n]F(x)$即可。</p>
<p>总结一下，这个递推式里面出现了$n^k$，它难以处理，先把这个$n$放到exp里，再把$n$放到外面作为指数，于是<strong>作为指数的点数</strong>，那这不就是明显的要把多项式往多项式里套吗？</p>
<h1 id="点双连通图计数"><a href="#点双连通图计数" class="headerlink" title="点双连通图计数"></a>点双连通图计数</h1><p>这个的主要思路和边双一样，也是转为有根树然后多项式复合，这里就需要圆方树了。令$F(x)$为有根边双连通图的EGF（可看作以圆点为根的广义圆方树的EGF，这里显然不能将方点算入点数），$G(x)$为以方点为根的广义圆方树的EGF，$P(x)$为点双连通图的EGF，$p_i$为$i$个点点双连通图个数。首先，$F(x)$仅仅是把方点子树无序一下加个根，即$F(x)=xe^{G(x)}$，$G(x)=\ln \frac {F(x)} x$，考虑方点为根，它确定了一个点双连通分量，点数为儿子个数+1（因为它一定有唯一的一个圆父亲），那么我们在方点处用$p$规划这个dcc中的连边方式。那么：$G(x)=\sum_{k=1}^∞\frac{p_{k+1}}{(k+1)!}F(x)^k=\frac{P(F(x))}{F(x)}-1$，于是$P(F(x))=F(x)(\ln\frac{F(x)}x+1)$，仍然扩展拉格朗日反演解$P(x)$。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ywy-c-asm.cn/2021/05/10/%E9%87%8D(kai)%E6%96%B0(shi)%E5%AD%A6%E4%B9%A0%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" data-id="ckpv6vf4s001h4gt2a6pwajkn" data-title="重(kai)新(shi)学习生成函数"></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ACM/" rel="tag">ACM</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/05/17/%E9%87%8D%E8%B5%B0OI%E8%B7%AF%EF%BC%9A2020-2021-OI%E9%A2%98%E6%B3%9B%E5%81%9A/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          重走OI路：2020-2021 OI题泛做
        
      </div>
    </a>
  
  
    <a href="/2021/05/09/%E9%87%8D%E6%96%B0%E5%AD%A6%E4%B9%A0%E5%A4%9A%E9%A1%B9%E5%BC%8F/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">重新学习多项式</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ACM/" rel="tag">ACM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLP/" rel="tag">NLP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E4%BB%8B%E7%BB%8D/" rel="tag">个人介绍</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/" rel="tag">位运算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%83%B3%E6%B3%95/" rel="tag">想法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">friends</h3>
    <div class="widget">
      <li><a target="_blank" rel="noopener" href="https://blog.i207m.top/" title="i207M">i207M</a></li>
      <li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/ywycasm/" title="Old ywy_c_asm">Old ywy_c_asm</a></li>
      <li><a target="_blank" rel="noopener" href="https://blog.csdn.net/lyd_7_29" title="lyd729">lyd729</a></li>
      <li><a target="_blank" rel="noopener" href="https://www.shadowice1984.xyz/" title="shadowice1984">shadowice1984</a></li>
      <li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Miracevin" title="Miracle">Miracle</a></li>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/06/13/2021-06-13-2021-CCPC-%E4%B8%9C%E5%8C%97%E5%9B%9B%E7%9C%81%E8%B5%9B-%E8%B5%9B%E5%90%8E%E8%A1%A5%E9%A2%98/">2021 CCPC 东北四省赛 赛后补题</a>
          </li>
        
          <li>
            <a href="/2021/06/05/NOI2019%E8%A1%A5%E9%A2%98/">NOI2019补题</a>
          </li>
        
          <li>
            <a href="/2021/06/03/CCPC2021%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81%E8%B5%9B-C%E9%A2%98/">CCPC2021黑龙江省赛 C题</a>
          </li>
        
          <li>
            <a href="/2021/05/31/Codeforces-Round-1523/">Codeforces Round 1523</a>
          </li>
        
          <li>
            <a href="/2021/05/29/%E9%87%8D%E8%B5%B0OI%E8%B7%AF%EF%BC%9A2020-2021-OI%E9%A2%98%E6%B3%9B%E5%81%9A%EF%BC%88%E4%BA%8C%EF%BC%89/">重走OI路：2020-2021 OI题泛做（二）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
	
<iframe id="iframe1" src="/balls3.html" style="height:500px;width:1500px;position:absolute;top:500px;left:0px;z-index:-1" scrolling="no" frameborder="0"></iframe>
		<script>
			var width=parseInt(document.body.clientWidth.toString().replace("px", ""), 10);
			var height=document.body.scrollHeight;
			iframe1.style='height:'+height+'px;width:'+width+'px;position:absolute;top:0px;left:0px;z-index:-1';
		</script>


      </div>
      <footer id="footer">
  <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": { 
        preferredFont: "TeX", 
        availableFonts: ["STIX","TeX"], 
        linebreaks: { automatic:true }, 
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) 
    },
    tex2jax: { 
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ], 
        processEscapes: true, 
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {  
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, 
        Macros: { href: "{}" } 
    },
    messageStyle: "none"
    }); 
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 ywy_c_asm<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>







    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>




</body>
</html>